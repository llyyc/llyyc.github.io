<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>OSI七层模型与TCP/IP四层模型 - llyyc的个人博客</title>
  <link rel="alternate" hreflang="en" href="https://llyyc.github.io" />

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="llyyc" />
  <meta name="description" content="以前虽然学校有学习过计算机网络，但是平时接触网络编程比较少，因此我对计算机网络只有个大概的印象。什么OSI七层模型，TCP/IP四层模型这样" />







<meta name="generator" content="Hugo 0.44" />


<link rel="canonical" href="https://llyyc.github.io/post/20180725/" />



<link rel="icon" href="/favicon.ico" />










<link href="/dist/jane.min.css?v=2.7.0" rel="stylesheet">




<meta property="og:title" content="OSI七层模型与TCP/IP四层模型" />
<meta property="og:description" content="以前虽然学校有学习过计算机网络，但是平时接触网络编程比较少，因此我对计算机网络只有个大概的印象。什么OSI七层模型，TCP/IP四层模型这样" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://llyyc.github.io/post/20180725/" />



<meta property="article:published_time" content="2018-07-25T01:00:23&#43;08:00"/>

<meta property="article:modified_time" content="2018-07-25T01:00:23&#43;08:00"/>











<meta itemprop="name" content="OSI七层模型与TCP/IP四层模型">
<meta itemprop="description" content="以前虽然学校有学习过计算机网络，但是平时接触网络编程比较少，因此我对计算机网络只有个大概的印象。什么OSI七层模型，TCP/IP四层模型这样">


<meta itemprop="datePublished" content="2018-07-25T01:00:23&#43;08:00" />
<meta itemprop="dateModified" content="2018-07-25T01:00:23&#43;08:00" />
<meta itemprop="wordCount" content="3898">



<meta itemprop="keywords" content="计算机网络,OSI七层模型,tcp/ip协议簇," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="OSI七层模型与TCP/IP四层模型"/>
<meta name="twitter:description" content="以前虽然学校有学习过计算机网络，但是平时接触网络编程比较少，因此我对计算机网络只有个大概的印象。什么OSI七层模型，TCP/IP四层模型这样"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo"> </a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://llyyc.github.io/">Home</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://llyyc.github.io/post/">Archives</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://llyyc.github.io/tags/">Tags</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://llyyc.github.io/categories/">Categories</a>
          
        
      </li>
    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
       
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
      <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://llyyc.github.io/">Home</a>
          

        

      </li>
    
      <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://llyyc.github.io/post/">Archives</a>
          

        

      </li>
    
      <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://llyyc.github.io/tags/">Tags</a>
          

        

      </li>
    
      <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://llyyc.github.io/categories/">Categories</a>
          

        

      </li>
    
    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">OSI七层模型与TCP/IP四层模型</h1>
      
      <div class="post-meta">
        <span class="post-time"> 2018-07-25 </span>
        <div class="post-category">
            
              <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"> 计算机网络 </a>
            
          </div>
        <span class="more-meta"> 3898 words </span>
        <span class="more-meta"> 8 min read </span>
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Table of Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#1-osi七层模型">1.OSI七层模型</a></li>
<li><a href="#2-tcp-ip协议簇">2.TCP/IP协议簇</a></li>
<li><a href="#3-tcp-udp">3.TCP/UDP</a>
<ul>
<li><a href="#1-tcp">(1)TCP</a></li>
<li><a href="#2-udp">(2)UDP</a></li>
<li><a href="#3-小结tcp-udp区别">(3)小结TCP/UDP区别</a></li>
<li><a href="#4-tcp粘包拆包与udp丢包">(4) TCP粘包拆包与UDP丢包</a>
<ul>
<li><a href="#1-tcp粘包拆包">(1) TCP粘包拆包</a></li>
<li><a href="#2-udp丢包">(2) UDP丢包</a></li>
</ul></li>
</ul></li>
<li><a href="#4-socket">4.Socket</a></li>
<li><a href="#参考资料">参考资料:</a></li>
</ul></li>
</ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      

<p>以前虽然学校有学习过计算机网络，但是平时接触网络编程比较少，因此我对计算机网络只有个大概的印象。什么OSI七层模型，TCP/IP四层模型这样表面的东西。但是到底哪七层哪四层？这两个模型有什么关系？TCP、UDP、FTP、HTTP这些协议到底是什么？又是什么关系？带着这些问题我开始从网上查找资料进行学习，并整理成这篇博文。</p>

<h2 id="1-osi七层模型">1.OSI七层模型</h2>

<p>开放系统互连参考模型 (Open System Interconnect 简称OSI）是国际标准化组织(ISO)和国际电报电话咨询委员会(CCITT)联合制定的开放系统互连参考模型，为开放式互连信息系统提供了一种功能结构的框架。它从低到高分别是：物理层、数据链路层、网络层、传输层、会话层、表示层和应用层。<br />
这里不详细说明OSI七层模型，附一张非常详细的图。
<img src="/image/NetWork/TCPIP.gif" alt="OSI七层模型" /></p>

<p>OSI 七层模型通过七个层次化的结构模型使不同的系统不同的网络之间实现可靠的通讯，因此其最主要的功能就是帮助不同类型的主机实现数据传输 。
完成中继功能的节点通常称为<strong>中继系统</strong>。在OSI七层模型中，处于不同层的中继系统具有不同的名称。<br />
一个设备工作在哪一层，关键看它工作时利用哪一层的数据头部信息。网桥工作时，是以MAC头部来决定转发端口的，因此显然它是数据链路层的设备。</p>

<p>物理层：网卡，网线，集线器，中继器，调制解调器</p>

<p>数据链路层：网桥，交换机(MAC)</p>

<p>网络层：路由器(IP)</p>

<p>网关工作在第四层传输层及其以上</p>

<p>集线器是物理层设备,采用广播的形式来传输信息。
交换机就是用来进行报文交换的机器。多为链路层设备(二层交换机)，能够进行地址学习，采用存储转发的形式来交换报文.。
路由器的一个作用是连通不同的网络，另一个作用是选择信息传送的线路。选择通畅快捷的近路，能大大提高通信速度，减轻网络系统通信负荷，节约网络系统资源，提高网络系统畅通率。</p>

<p><strong>常见的数据单元如下:</strong>
物理层  比特（bit）</p>

<p>数据链路层： 帧(frame)</p>

<p>网络层： 数据报/包 (packet)</p>

<p>运输层： 数据段(segment)</p>

<p>会话层、表示层、应用层：一般就称呼为消息（message)</p>

<p>数据链路层的PDU叫做Frame（帧）；</p>

<p>网络层的PDU叫做Packet（数据包）；</p>

<p>TCP的叫做Segment（数据段）；</p>

<p>UDP的叫做Datagram。（数据报）——<strong>和网络层的Packet区别开，太过理论了，不讨论。</strong></p>

<hr />

<h2 id="2-tcp-ip协议簇">2.TCP/IP协议簇</h2>

<p>互联网协议族（Internet Protocol Suite，缩写IPS）是一个网络通信模型，以及一整个网络传输协议家族，
为互联网的基础通信架构。它常被通称为TCP/IP协议族（TCP/IP Protocol Suite，或TCP/IP Protocols），
简称TCP/IP。
TCP/IP提供点对点的链接机制，将数据应该如何封装、定址、传输、路由以及在目的地如何接收，都加以标
准化。它通常将软件通信过程抽象化为四个抽象层，采取协议堆栈的方式，分别实现出不同通信协议。协议套组下的各种协议，依其功能不同，被分别归属到这四个层次结构之中，常被视为是简化的七层OSI模型。与OSI对应关系如下:</p>

<p><img src="/image/NetWork/OSI与TCPIP.png" alt="OSI七层模型与TCP/IP四层模型" /></p>

<p>在上面，通常我们是把TCP/IP协议族分为四层，但是如果是五层的话就是在链路层下再加个物理层。下面是对各层的详细介绍。</p>

<p><img src="/image/NetWork/TCPIP2.png" alt="TCP/IP四层介绍" /></p>

<hr />

<h2 id="3-tcp-udp">3.TCP/UDP</h2>

<p>从上面的学习我们可以知道TCP和UDP协议都属于TCP/IP模型中的传输层协议。</p>

<h3 id="1-tcp">(1)TCP</h3>

<p>TCP（Transmission Control Protocol，传输控制协议）是<strong><em>面向连接</em></strong>的协议，也就是说，在收发数据前，必须和对方建立<strong><em>可靠</em></strong>的连接。一个TCP连接必须要经过三次“对话”才能建立起来，其中的过程非常复杂，只简单的描述下这三次对话的简单过程：</p>

<p><strong>（1） 第一次握手</strong>：建立连接时，客户端发送syn包（syn=j）到服务器，并进入SYN_SENT状态，等待服务器确认；SYN：同步序列编号（Synchronize Sequence Numbers）。</p>

<p><strong>（2） 第二次握手</strong>：服务器收到syn包，必须确认客户的SYN（ack=j+1），同时自己也发送一个SYN包（syn=k），即SYN+ACK包，此时服务器进入SYN_RECV状态；</p>

<p><strong>（3） 第三次握手</strong> ：客户端收到服务器的SYN+ACK包，向服务器发送确认包ACK(ack=k+1），此包发送完毕，客户端和服务器进入ESTABLISHED状态，完成三次握手。
关于需要握手三次的理解：TCP是一种可靠的传输，所以建立连接的时候也是需要保证可靠的，应答机制是必不可少的。A和B要完成一次完整的信息交互：A向B发送了一次数据，B必须告诉A自己收到数据，并且告诉一些信息给A，这就导致第二次数据的发送，当然A收到B发过来的数据，也必须告诉B自己收到了数据，所以A需要再一次发送数据给B。这三次是完成一个信息交互最基本的过程，整个过程感觉上是一问一答，有问必答的形式。</p>

<p>TCP建立连接要进行3次握手,而断开连接要进行4次：</p>

<p><strong>（1）</strong> 当主机A完成数据传输后,将控制位FIN置1,提出停止TCP连接的请求</p>

<p><strong>（2）</strong> 主机B收到FIN后对其作出响应,确认这一方向上的TCP连接将关闭,将ACK置1</p>

<p><strong>（3）</strong> 由B 端再提出反方向的关闭请求,将FIN置1</p>

<p><strong>（4）</strong> 主机A对主机B的请求进行确认,将ACK置1,双方向的关闭结束。</p>

<p><strong>为什么需要分为四次的原因：</strong>
这是因为服务端的LISTEN状态下的SOCKET当收到SYN报文的建连请求后，它可以把ACK和SYN（ACK起应答作用，而SYN起同步作用）放在一个报文里来发送。但关闭连接时，当收到对方的FIN报文通知时，它仅仅表示对方没有数据发送给你了；但未必你所有的数据都全部发送给对方了，所以你可以<strong>未必会马上会关闭SOCKET</strong>,也即你可能还需要发送一些数据给对方之后，再发送FIN报文给对方来表示你同意现在可以关闭连接了，所以它这里的ACK报文和FIN报文多数情况下都是分开发送的。</p>

<p>下面用两张图更为简洁明了地展示三次握手和四次挥手:</p>

<p><strong>三次握手：</strong></p>

<p><img src="/image/NetWork/三次握手.png" alt="三次握手" /></p>

<p><strong>四次挥手：</strong></p>

<p><img src="/image/NetWork/四次挥手.png" alt="四次挥手" /></p>

<h3 id="2-udp">(2)UDP</h3>

<p><strong>（1）</strong> UDP是一个非连接的协议，传输数据之前源端和终端<strong>不建立连接</strong>，当它想传送时就简单地去抓取来自应用程序的数据，并尽可能快地把它扔到网络上。在发送端，UDP传送数据的速度仅仅是受应用程序生成数据的速度、计算机的能力和传输带宽的限制；在接收端，UDP把每个消息段放在队列中，应用程序每次从队列中读一个消息段。</p>

<p><strong>（2）</strong> 由于传输数据不建立连接，因此也就不需要维护连接状态，包括收发状态等，<strong>因此一台服务机可同时向多个客户机传输相同的消息</strong>。</p>

<p><strong>（3）</strong> UDP信息包的标题很短，只有8个字节，相对于TCP的20个字节信息包的额外开销很小。</p>

<p><strong>（4）</strong> 吞吐量不受拥挤控制算法的调节，只受应用软件生成数据的速率、传输带宽、源端和终端主机性能的限制。</p>

<p><strong>（5）</strong> UDP使用尽最大努力交付，即<strong>不保证可靠交付</strong>，因此主机不需要维持复杂的链接状态表（这里面有许多参数）。</p>

<p><strong>（6）</strong> UDP是面向报文的。发送方的UDP对应用程序交下来的报文，在添加首部后就向下交付给IP层。<strong>既不拆分，也不合并</strong>，而是保留这些报文的边界，因此，应用程序需要选择合适的报文大小。
我们经常使用“ping”命令来测试两台主机之间TCP/IP通信是否正常，其实“ping”命令的原理就是向对方主机发送UDP数据包，然后对方主机确认收到数据包，如果数据包是否到达的消息及时反馈回来，那么网络就是通的。</p>

<h3 id="3-小结tcp-udp区别">(3)小结TCP/UDP区别</h3>

<p>1.基于连接与无连接；</p>

<p>2.对系统资源的要求(TCP较多，UDP少)；</p>

<p>3.UDP程序结构较简单；</p>

<p>4.流模式与数据报模式 ；</p>

<p>5.TCP保证数据正确性，UDP可能丢包，TCP保证数据顺序，UDP不保证。</p>

<p>注：
关于第4点不同的解释：
用UDP协议发送时，用sendto函数最大能发送数据的长度为：65535－20－8＝65507字节，其中20字节为IP包头长度，8字节为UDP包头长度。用sendto函数发送数据时，如果指的的数据长度大于该值，则函数会返回错误。
用TCP协议发送时，由于TCP是<strong>数据流</strong>协议，因此不存在包大小的限制（暂不考虑缓冲区的大小），这是指在用send函数时，数据长度参数不受限制。而实际上，所指定的这段数据并不一定会一次性发送出去，如果这段数据比较长，可能会被分段发送，如果比较短，可能会等待和下一次数据一起发送。
关于第5点不同的解释：
多线程的调度问题，先发的后调度，后发的先调度，以及路由选择的不同路径都可能造成UDP数据到达的无序性。</p>

<hr />

<h3 id="4-tcp粘包拆包与udp丢包">(4) TCP粘包拆包与UDP丢包</h3>

<h4 id="1-tcp粘包拆包">(1) TCP粘包拆包</h4>

<p>TCP是数据流传输，没有边界。为了效率，TCP接受到应用数据不是马上发送到网络，而是根据默认使用的Nagle算法来进行缓存。简单的说，如果一个数据包太大，就会进行拆包，然后先发送部分。如果几个数据包太小，则拼接起来一起发送。
对于处理粘包的关键在于提前获取到数据包的长度，无论这个长度是提前商定好的还是写在在数据包的开头。 详细可以看<a href="https://blog.csdn.net/bjrxyz/article/details/73351248">这篇博客</a>。</p>

<h4 id="2-udp丢包">(2) UDP丢包</h4>

<p>上面讲到，UDP不保证可靠的交付。因为网络、接收方、发送方一些原因，会导致包的丢失。因为UDP丢包的原因比较复杂，这里不详细讨论了。</p>

<hr />

<h2 id="4-socket">4.Socket</h2>

<p>Socket是应用层与TCP/IP协议族通信的中间软件抽象层，它是一组接口。在设计模式中，Socket其实就是一个门面模式，它把复杂的TCP/IP协议族隐藏在Socket接口后面，对用户来说，一组简单的接口就是全部，让Socket去组织数据，以符合指定的协议。
Socket 接口是TCP/IP网络的API，Socket接口定义了许多函数或例程，用以开发TCP/IP网络上的应用程序。粗俗的讲，Socket只是方便我们实现TCP/UDP的工具类。</p>

<h2 id="参考资料">参考资料:</h2>

<ol>
<li><a href="https://blog.csdn.net/laoniu_c/article/details/39237415">TCP和UDP的传输过程以及二者之间的区别</a></li>
<li><a href="https://blog.csdn.net/qq_35644234/article/details/68951041">TCP/IP协议族分层详解</a></li>
<li><a href="https://www.jianshu.com/p/e7f45779008a">tcp建立连接为什么需要三次握手</a></li>
<li><a href="https://blog.csdn.net/bjrxyz/article/details/73351248">TCP新手误区&ndash;粘包的处理</a></li>
</ol>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">llyyc</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">2018-07-25</span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">License</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>

    
    

    <footer class="post-footer">
      <div class="post-tags">
          
          <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a>
          
          <a href="/tags/osi%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B/">OSI七层模型</a>
          
          <a href="/tags/tcp/ip%E5%8D%8F%E8%AE%AE%E7%B0%87/">tcp/ip协议簇</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/20180727/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">使用CSharp封装类简单实现TCP/UDP</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
          <a class="next" href="/post/20180721/">
            <span class="next-text nav-default">ulua官方案例解析</span>
            <span class="prev-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="490571953@qq.com" rel="me noopener" class="iconfont icon-email"
        title="email" target="_blank">
      </a>
  <a href="https://llyyc.github.io/index.xml" rel="noopener" type="application/rss+xml" class="iconfont icon-rss"
    title="rss" target="_blank">
  </a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    2018
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span><span class="author">llyyc</span></span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
<script type="text/javascript" src="/dist/jane.min.js?v=2.7.0"></script>





  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  





</body>
</html>
